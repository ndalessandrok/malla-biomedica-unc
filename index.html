<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malla Curricular - IngenierÃ­a BiomÃ©dica UNC</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-color: #1e293b;
            --border-color: #e2e8f0;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-color: #f1f5f9;
            --border-color: #334155;
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), #3b82f6);
            color: white;
            padding: 1rem 0;
            box-shadow: var(--shadow);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .btn-primary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .stats-panel {
            background: var(--card-bg);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .stat-item {
            text-align: center;
            padding: 1rem;
            border-radius: 0.375rem;
            background: var(--bg-color);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--secondary-color);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-color);
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .semester-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .semester {
            background: var(--card-bg);
            border-radius: 0.5rem;
            padding: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow);
        }

        .semester-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
        }

        .subject {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            padding: 1rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .subject:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .subject.completed {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border-color: var(--success-color);
        }

        .subject.available {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-color: var(--warning-color);
        }

        .subject.locked {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-color: var(--danger-color);
            opacity: 0.6;
        }

        .subject-name {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .subject-code {
            font-size: 0.75rem;
            color: var(--secondary-color);
            font-family: monospace;
        }

        .subject-credits {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: var(--primary-color);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .subject-status {
            margin-top: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .subject-grade {
            margin-top: 0.25rem;
            font-size: 0.75rem;
        }

        .grade-input {
            width: 60px;
            padding: 0.25rem;
            border: 1px solid var(--border-color);
            border-radius: 0.25rem;
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 0.75rem;
        }

        .area-matematicas { border-left: 4px solid #ef4444; }
        .area-fisica { border-left: 4px solid #3b82f6; }
        .area-quimica { border-left: 4px solid #10b981; }
        .area-biomedica { border-left: 4px solid #8b5cf6; }
        .area-electronica { border-left: 4px solid #f59e0b; }
        .area-informatica { border-left: 4px solid #06b6d4; }
        .area-ingenieria { border-left: 4px solid #84cc16; }
        .area-general { border-left: 4px solid #6b7280; }

        .legend {
            display: flex;
            gap: 2rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .legend-color {
            width: 1rem;
            height: 1rem;
            border-radius: 0.25rem;
            border: 1px solid var(--border-color);
        }

        .progress-bar {
            width: 100%;
            height: 0.5rem;
            background: var(--border-color);
            border-radius: 0.25rem;
            overflow: hidden;
            margin: 0.5rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--success-color));
            transition: width 0.3s ease;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 0.5rem;
            padding: 2rem;
            margin: 5% auto;
            max-width: 500px;
            position: relative;
        }

        .close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary-color);
        }

        .close:hover {
            color: var(--text-color);
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .semester-grid {
                grid-template-columns: 1fr;
            }
            
            .filters {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="header-title">Malla Curricular - IngenierÃ­a BiomÃ©dica UNC</h1>
                <div class="header-controls">
                    <button class="btn btn-primary" onclick="toggleTheme()">ðŸŒ™ Modo Oscuro</button>
                    <button class="btn btn-primary" onclick="exportData()">ðŸ“Š Exportar Datos</button>
                    <button class="btn btn-primary" onclick="resetData()">ðŸ”„ Reiniciar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="stats-panel">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="completedCount">0</div>
                    <div class="stat-label">Materias Aprobadas</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="availableCount">0</div>
                    <div class="stat-label">Materias Disponibles</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalCredits">0</div>
                    <div class="stat-label">CrÃ©ditos Obtenidos</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="avgGrade">-</div>
                    <div class="stat-label">Promedio</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="filters">
            <button class="filter-btn active" data-filter="all">Todas</button>
            <button class="filter-btn" data-filter="matematicas">MatemÃ¡ticas</button>
            <button class="filter-btn" data-filter="fisica">FÃ­sica</button>
            <button class="filter-btn" data-filter="quimica">QuÃ­mica</button>
            <button class="filter-btn" data-filter="biomedica">BiomÃ©dica</button>
            <button class="filter-btn" data-filter="electronica">ElectrÃ³nica</button>
            <button class="filter-btn" data-filter="informatica">InformÃ¡tica</button>
            <button class="filter-btn" data-filter="ingenieria">IngenierÃ­a</button>
            <button class="filter-btn" data-filter="general">General</button>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #dcfce7, #bbf7d0);"></div>
                <span>Aprobada</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #fef3c7, #fde68a);"></div>
                <span>Disponible</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: linear-gradient(135deg, #fee2e2, #fecaca);"></div>
                <span>Bloqueada</span>
            </div>
        </div>

        <div class="semester-grid" id="semesterGrid">
        </div>
    </div>

    <div class="modal" id="subjectModal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modalTitle"></h2>
            <p id="modalCode"></p>
            <div id="modalGrade"></div>
            <div id="modalPrereqs"></div>
            <div id="modalUnlocks"></div>
        </div>
    </div>

    <script>
        const subjects = {
            // NivelaciÃ³n
            'ambientacion': {
                name: 'AmbientaciÃ³n Universitaria',
                code: '10-04050',
                credits: 1,
                semester: 'nivelacion',
                area: 'general',
                prerequisites: [],
                status: 'completed',
                grade: 10
            },
            'matematica_niv': {
                name: 'MatemÃ¡tica',
                code: '10-04051',
                credits: 3,
                semester: 'nivelacion',
                area: 'matematicas',
                prerequisites: [],
                status: 'completed',
                grade: 10
            },
            'fisica_quimica': {
                name: 'FÃ­sica y QuÃ­mica',
                code: '10-04052',
                credits: 3,
                semester: 'nivelacion',
                area: 'fisica',
                prerequisites: [],
                status: 'completed',
                grade: 10
            },

            // Primer AÃ±o - Primer Semestre
            'analisis1': {
                name: 'AnÃ¡lisis MatemÃ¡tico 1',
                code: '10-04053',
                credits: 7,
                semester: '1s',
                area: 'matematicas',
                prerequisites: ['matematica_niv'],
                status: 'completed',
                grade: 9
            },
            'quimica': {
                name: 'QuÃ­mica',
                code: '10-04057',
                credits: 5,
                semester: '1s',
                area: 'quimica',
                prerequisites: ['fisica_quimica'],
                status: 'completed',
                grade: 7
            },
            'taller_lab': {
                name: 'Taller y Laboratorio',
                code: '10-04058',
                credits: 6,
                semester: '1s',
                area: 'general',
                prerequisites: [],
                status: 'completed',
                grade: 6.5
            },

            // Primer AÃ±o - Segundo Semestre
            'algebra': {
                name: 'Ãlgebra Lineal',
                code: '10-04059',
                credits: 7,
                semester: '2s',
                area: 'matematicas',
                prerequisites: ['analisis1'],
                status: 'completed',
                grade: 7
            },
            'fisica1': {
                name: 'FÃ­sica 1',
                code: '10-04060',
                credits: 7,
                semester: '2s',
                area: 'fisica',
                prerequisites: ['analisis1'],
                status: 'completed',
                grade: 8
            },
            'quimica_org': {
                name: 'QuÃ­mica OrgÃ¡nica y BiolÃ³gica',
                code: '10-09200',
                credits: 5,
                semester: '2s',
                area: 'quimica',
                prerequisites: ['quimica'],
                status: 'completed',
                grade: 7
            },
            'sistemas_rep': {
                name: 'Sistemas de RepresentaciÃ³n',
                code: '10-04055',
                credits: 7,
                semester: '2s',
                area: 'general',
                prerequisites: [],
                status: 'available',
                grade: null
            },

            // Segundo AÃ±o - Primer Semestre
            'analisis2': {
                name: 'AnÃ¡lisis MatemÃ¡tico 2',
                code: '10-04063',
                credits: 7,
                semester: '3s',
                area: 'matematicas',
                prerequisites: ['algebra'],
                status: 'completed',
                grade: 5
            },
            'anatomia': {
                name: 'AnatomÃ­a para Ingenieros',
                code: '10-09201',
                credits: 4,
                semester: '3s',
                area: 'biomedica',
                prerequisites: ['quimica_org'],
                status: 'available',
                grade: null
            },
            'estatica': {
                name: 'EstÃ¡tica y Resistencia de los Materiales',
                code: '10-09202',
                credits: 6,
                semester: '3s',
                area: 'ingenieria',
                prerequisites: ['fisica1'],
                status: 'available',
                grade: null
            },
            'fisica2': {
                name: 'FÃ­sica 2',
                code: '10-04067',
                credits: 7,
                semester: '3s',
                area: 'fisica',
                prerequisites: ['fisica1'],
                status: 'available',
                grade: null
            },
            'ingles': {
                name: 'MÃ³dulo de InglÃ©s',
                code: '10-04066',
                credits: 3,
                semester: '3s',
                area: 'general',
                prerequisites: [],
                status: 'completed',
                grade: 8
            },

            // Segundo AÃ±o - Segundo Semestre
            'analisis3': {
                name: 'AnÃ¡lisis MatemÃ¡tico 3',
                code: '10-04070',
                credits: 7,
                semester: '4s',
                area: 'matematicas',
                prerequisites: ['analisis2'],
                status: 'completed',
                grade: 7
            },
            'electronica': {
                name: 'ElectrÃ³nica',
                code: '10-04074',
                credits: 6,
                semester: '4s',
                area: 'electronica',
                prerequisites: ['fisica2'],
                status: 'locked',
                grade: null
            },
            'histologia': {
                name: 'HistologÃ­a para Ingenieros',
                code: '10-09203',
                credits: 4,
                semester: '4s',
                area: 'biomedica',
                prerequisites: ['anatomia'],
                status: 'locked',
                grade: null
            },
            'informatica': {
                name: 'InformÃ¡tica y CÃ¡lculo NumÃ©rico',
                code: '10-04061',
                credits: 8,
                semester: '4s',
                area: 'informatica',
                prerequisites: ['algebra'],
                status: 'completed',
                grade: 8
            },
            'probabilidad': {
                name: 'Probabilidad y EstadÃ­stica',
                code: '10-04062',
                credits: 5,
                semester: '4s',
                area: 'matematicas',
                prerequisites: ['analisis2'],
                status: 'locked',
                grade: null
            },

            // Tercer AÃ±o - Primer Semestre
            'digital1': {
                name: 'ElectrÃ³nica Digital 1',
                code: '10-04068',
                credits: 8,
                semester: '5s',
                area: 'electronica',
                prerequisites: ['electronica'],
                status: 'locked',
                grade: null
            },
            'electrotecnia': {
                name: 'Electrotecnia General y MÃ¡quinas ElÃ©ctricas',
                code: '10-09204',
                credits: 8,
                semester: '5s',
                area: 'electronica',
                prerequisites: ['electronica'],
                status: 'locked',
                grade: null
            },
            'fisiologia': {
                name: 'FisiologÃ­a Humana',
                code: '10-09205',
                credits: 4,
                semester: '5s',
                area: 'biomedica',
                prerequisites: ['histologia'],
                status: 'locked',
                grade: null
            },
            'senales': {
                name: 'SeÃ±ales y Sistemas',
                code: '10-04076',
                credits: 8,
                semester: '5s',
                area: 'electronica',
                prerequisites: ['analisis3'],
                status: 'locked',
                grade: null
            },

            // Tercer AÃ±o - Segundo Semestre
            'biomateriales': {
                name: 'Biomateriales',
                code: '10-09206',
                credits: 6,
                semester: '6s',
                area: 'biomedica',
                prerequisites: ['quimica_org'],
                status: 'available',
                grade: null
            },
            'digital2': {
                name: 'ElectrÃ³nica Digital 2',
                code: '10-04071',
                credits: 8,
                semester: '6s',
                area: 'electronica',
                prerequisites: ['digital1'],
                status: 'locked',
                grade: null
            },
            'fisica_biomedica': {
                name: 'FÃ­sica BiomÃ©dica',
                code: '10-09207',
                credits: 4,
                semester: '6s',
                area: 'fisica',
                prerequisites: ['fisica2'],
                status: 'locked',
                grade: null
            },
            'ing_economica': {
                name: 'IngenierÃ­a EconÃ³mica y Legal',
                code: '10-04064',
                credits: 6,
                semester: '6s',
                area: 'ingenieria',
                prerequisites: [],
                status: 'available',
                grade: null
            },
            'control': {
                name: 'TeorÃ­a de Redes y Control',
                code: '10-09208',
                credits: 6,
                semester: '6s',
                area: 'electronica',
                prerequisites: ['senales'],
                status: 'locked',
                grade: null
            },

            // Cuarto AÃ±o - Primer Semestre
            'analogica': {
                name: 'ElectrÃ³nica AnalÃ³gica',
                code: '10-09209',
                credits: 6,
                semester: '7s',
                area: 'electronica',
                prerequisites: ['electronica'],
                status: 'locked',
                grade: null
            },
            'fisiopatologia': {
                name: 'FisiopatologÃ­a',
                code: '10-09210',
                credits: 4,
                semester: '7s',
                area: 'biomedica',
                prerequisites: ['fisiologia'],
                status: 'locked',
                grade: null
            },
            'instalaciones': {
                name: 'Instalaciones Hospitalarias',
                code: '10-09211',
                credits: 10,
                semester: '7s',
                area: 'ingenieria',
                prerequisites: ['electrotecnia'],
                status: 'locked',
                grade: null
            },
            'procesamiento': {
                name: 'Procesamiento de SeÃ±ales',
                code: '10-09212',
                credits: 6,
                semester: '7s',
                area: 'electronica',
                prerequisites: ['senales'],
                status: 'locked',
                grade: null
            },
            'transductores': {
                name: 'Transductores y Sensores',
                code: '10-09213',
                credits: 8,
                semester: '7s',
                area: 'electronica',
                prerequisites: ['analogica'],
                status: 'locked',
                grade: null
            },

            // Cuarto AÃ±o - Segundo Semestre
            'biomecanica': {
                name: 'BiomecÃ¡nica',
                code: '10-09214',
                credits: 6,
                semester: '8s',
                area: 'biomedica',
                prerequisites: ['fisiologia', 'estatica'],
                status: 'locked',
                grade: null
            },
            'imagenes': {
                name: 'ImÃ¡genes en Medicina',
                code: '10-09215',
                credits: 7,
                semester: '8s',
                area: 'biomedica',
                prerequisites: ['procesamiento'],
                status: 'locked',
                grade: null
            },
            'instrumentacion': {
                name: 'InstrumentaciÃ³n BiomÃ©dica',
                code: '10-09216',
                credits: 10,
                semester: '8s',
                area: 'biomedica',
                prerequisites: ['transductores'],
                status: 'locked',
                grade: null
            },
            'practica': {
                name: 'PrÃ¡ctica Profesional Supervisada',
                code: '10-09217',
                credits: 10,
                semester: '8s',
                area: 'general',
                prerequisites: ['instrumentacion'],
                status: 'locked',
                grade: null
            },

            // Quinto AÃ±o - Primer Semestre
            'rehabilitacion': {
                name: 'IngenierÃ­a en RehabilitaciÃ³n',
                code: '10-09218',
                credits: 7,
                semester: '9s',
                area: 'biomedica',
                prerequisites: ['biomecanica'],
                status: 'locked',
                grade: null
            },
            'hospitalaria': {
                name: 'IngenierÃ­a Hospitalaria',
                code: '10-09219',
                credits: 7,
                semester: '9s',
                area: 'ingenieria',
                prerequisites: ['instalaciones'],
                status: 'locked',
                grade: null
            },
            'modelos': {
                name: 'Modelos y Simulaciones',
                code: '10-09220',
                credits: 7,
                semester: '9s',
                area: 'informatica',
                prerequisites: ['informatica'],
                status: 'available',
                grade: null
            },
            'radiaciones': {
                name: 'Radiaciones Ionizantes en Medicina',
                code: '10-09222',
                credits: 7,
                semester: '9s',
                area: 'fisica',
                prerequisites: ['fisica_biomedica'],
                status: 'locked',
                grade: null
            },

            // Quinto AÃ±o - Segundo Semestre
            'higiene': {
                name: 'Higiene y Seguridad',
                code: '10-04078',
                credits: 7,
                semester: '10s',
                area: 'general',
                prerequisites: [],
                status: 'available',
                grade: null
            },
            'seguridad': {
                name: 'Seguridad y NormalizaciÃ³n BiomÃ©dica',
                code: '10-09223',
                credits: 7,
                semester: '10s',
                area: 'biomedica',
                prerequisites: ['instrumentacion'],
                status: 'locked',
                grade: null
            },
            'proyecto': {
                name: 'Proyecto Integrador',
                code: '10-09225',
                credits: 13,
                semester: '10s',
                area: 'general',
                prerequisites: ['practica'],
                status: 'locked',
                grade: null
            }
        };

        const semesterNames = {
            'nivelacion': 'NivelaciÃ³n',
            '1s': '1er AÃ±o - 1er Semestre',
            '2s': '1er AÃ±o - 2do Semestre',
            '3s': '2do AÃ±o - 1er Semestre',
            '4s': '2do AÃ±o - 2do Semestre',
            '5s': '3er AÃ±o - 1er Semestre',
            '6s': '3er AÃ±o - 2do Semestre',
            '7s': '4to AÃ±o - 1er Semestre',
            '8s': '4to AÃ±o - 2do Semestre',
            '9s': '5to AÃ±o - 1er Semestre',
            '10s': '5to AÃ±o - 2do Semestre'
        };

        let currentFilter = 'all';
        let isDarkMode = false;

        function updateSubjectStatus() {
            Object.keys(subjects).forEach(subjectId => {
                const subject = subjects[subjectId];
                if (subject.status === 'completed') return;

                const prereqsMet = subject.prerequisites.every(prereq => 
                    subjects[prereq] && subjects[prereq].status === 'completed'
                );
                
                subject.status = prereqsMet ? 'available' : 'locked';
            });
        }

        function calculateStats() {
            const completed = Object.values(subjects).filter(s => s.status === 'completed');
            const available = Object.values(subjects).filter(s => s.status === 'available');
            const totalCredits = completed.reduce((sum, s) => sum + s.credits, 0);
            const totalSubjects = Object.keys(subjects).length;
            
            let avgGrade = 0;
            const gradesWithValues = completed.filter(s => s.grade !== null && s.grade !== undefined);
            if (gradesWithValues.length > 0) {
                avgGrade = gradesWithValues.reduce((sum, s) => sum + s.grade, 0) / gradesWithValues.length;
            }

            document.getElementById('completedCount').textContent = completed.length;
            document.getElementById('availableCount').textContent = available.length;
            document.getElementById('totalCredits').textContent = totalCredits;
            document.getElementById('avgGrade').textContent = avgGrade > 0 ? avgGrade.toFixed(2) : '-';
            
            const progress = (completed.length / totalSubjects) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function renderSemesters() {
            const grid = document.getElementById('semesterGrid');
            grid.innerHTML = '';

            const semesterOrder = ['nivelacion', '1s', '2s', '3s', '4s', '5s', '6s', '7s', '8s', '9s', '10s'];
            
            semesterOrder.forEach(semesterId => {
                const semesterSubjects = Object.entries(subjects)
                    .filter(([_, subject]) => subject.semester === semesterId)
                    .filter(([_, subject]) => currentFilter === 'all' || subject.area === currentFilter);

                if (semesterSubjects.length === 0) return;

                const semesterDiv = document.createElement('div');
                semesterDiv.className = 'semester';
                semesterDiv.innerHTML = `
                    <h3 class="semester-title">${semesterNames[semesterId]}</h3>
                    ${semesterSubjects.map(([id, subject]) => `
                        <div class="subject ${subject.status} area-${subject.area}" onclick="openSubjectModal('${id}')">
                            <div class="subject-credits">${subject.credits}</div>
                            <div class="subject-name">${subject.name}</div>
                            <div class="subject-code">${subject.code}</div>
                            <div class="subject-status">
                                ${subject.status === 'completed' ? 'âœ… Aprobada' : 
                                  subject.status === 'available' ? 'ðŸ“š Disponible' : 'ðŸ”’ Bloqueada'}
                            </div>
                            ${subject.status === 'completed' && subject.grade ? 
                                `<div class="subject-grade">Nota: ${subject.grade}</div>` : ''}
                        </div>
                    `).join('')}
                `;
                grid.appendChild(semesterDiv);
            });
        }

        function openSubjectModal(subjectId) {
            const subject = subjects[subjectId];
            const modal = document.getElementById('subjectModal');
            
            document.getElementById('modalTitle').textContent = subject.name;
            document.getElementById('modalCode').textContent = `CÃ³digo: ${subject.code} | CrÃ©ditos: ${subject.credits}`;
            
            const gradeHtml = subject.status === 'completed' ? 
                `<div><strong>Nota:</strong> 
                    <input type="number" 
                           class="grade-input" 
                           value="${subject.grade || ''}" 
                           min="1" 
                           max="10" 
                           step="0.1"
                           onchange="updateGrade('${subjectId}', this.value)">
                </div>` : 
                `<div><strong>Estado:</strong> ${
                    subject.status === 'available' ? 'Disponible para cursar' : 'Bloqueada'
                }</div>`;
            
            document.getElementById('modalGrade').innerHTML = gradeHtml;
            
            const prereqs = subject.prerequisites.map(prereq => subjects[prereq].name).join(', ');
            document.getElementById('modalPrereqs').innerHTML = prereqs ? 
                `<div><strong>Prerrequisitos:</strong> ${prereqs}</div>` : 
                '<div><strong>Prerrequisitos:</strong> Ninguno</div>';
            
            const unlocks = Object.entries(subjects)
                .filter(([_, s]) => s.prerequisites.includes(subjectId))
                .map(([_, s]) => s.name)
                .join(', ');
            
            document.getElementById('modalUnlocks').innerHTML = unlocks ? 
                `<div><strong>Habilita:</strong> ${unlocks}</div>` : 
                '<div><strong>Habilita:</strong> Ninguna materia especÃ­fica</div>';
            
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('subjectModal').style.display = 'none';
        }

        function updateGrade(subjectId, grade) {
            const numGrade = parseFloat(grade);
            if (numGrade >= 1 && numGrade <= 10) {
                subjects[subjectId].grade = numGrade;
                if (numGrade >= 4 && subjects[subjectId].status !== 'completed') {
                    subjects[subjectId].status = 'completed';
                    updateSubjectStatus();
                    renderSemesters();
                }
                calculateStats();
                saveData();
            }
        }

        function toggleSubjectStatus(subjectId) {
            const subject = subjects[subjectId];
            if (subject.status === 'completed') {
                subject.status = 'available';
                subject.grade = null;
            } else if (subject.status === 'available') {
                subject.status = 'completed';
                subject.grade = subject.grade || 7;
            }
            
            updateSubjectStatus();
            renderSemesters();
            calculateStats();
            saveData();
        }

        function setFilter(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
            renderSemesters();
        }

        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.setAttribute('data-theme', isDarkMode ? 'dark' : 'light');
            document.querySelector('.btn-primary').innerHTML = isDarkMode ? 'â˜€ï¸ Modo Claro' : 'ðŸŒ™ Modo Oscuro';
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
        }

        function saveData() {
            localStorage.setItem('subjectsData', JSON.stringify(subjects));
        }

        function loadData() {
            const savedData = localStorage.getItem('subjectsData');
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                Object.keys(parsedData).forEach(key => {
                    if (subjects[key]) {
                        subjects[key].status = parsedData[key].status;
                        subjects[key].grade = parsedData[key].grade;
                    }
                });
            }
        }

        function exportData() {
            const data = {
                subjects: subjects,
                exported: new Date().toISOString(),
                student: "D'ALESSANDRO, NADINE",
                legajo: "44519926"
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'progreso_malla_biomedica.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function resetData() {
            if (confirm('Â¿EstÃ¡s seguro de que quieres reiniciar todo el progreso?')) {
                Object.keys(subjects).forEach(key => {
                    if (!['ambientacion', 'matematica_niv', 'fisica_quimica', 'analisis1', 'quimica', 
                          'taller_lab', 'algebra', 'fisica1', 'quimica_org', 'analisis2', 'ingles', 
                          'analisis3', 'informatica'].includes(key)) {
                        subjects[key].status = 'locked';
                        subjects[key].grade = null;
                    }
                });
                updateSubjectStatus();
                renderSemesters();
                calculateStats();
                saveData();
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', () => {
            // Load saved theme
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                toggleTheme();
            }
            
            // Load saved data
            loadData();
            
            // Setup filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => setFilter(btn.dataset.filter));
            });
            
            // Close modal when clicking outside
            document.getElementById('subjectModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('subjectModal')) {
                    closeModal();
                }
            });
            
            // Initialize
            updateSubjectStatus();
            renderSemesters();
            calculateStats();
        });

        // Double click to toggle subject status
        document.addEventListener('dblclick', (e) => {
            if (e.target.closest('.subject')) {
                e.preventDefault();
                const subjectElement = e.target.closest('.subject');
                const subjectId = Object.keys(subjects).find(id => 
                    subjectElement.innerHTML.includes(subjects[id].code)
                );
                if (subjectId) {
                    toggleSubjectStatus(subjectId);
                }
            }
        });
    </script>
</body>
</html>
</body>
</html>
